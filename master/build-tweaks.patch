Collection of tweaks to Xen versioning information

* Version reduced to $X.$Y.$Z for RPM packaging
* Banner stripped back to Xen-$X.$Y.$Z while keeping -xs$BUILDNUM in the full version
* scmversion updated to split underlying changeset from patchqueue changeset

diff --git a/xen/Makefile b/xen/Makefile
index ee0bcfc..cfd1096 100644
--- a/xen/Makefile
+++ b/xen/Makefile
@@ -2,7 +2,7 @@
 # All other places this is stored (eg. compile.h) should be autogenerated.
 export XEN_VERSION       = 4
 export XEN_SUBVERSION    = 5
-export XEN_EXTRAVERSION ?= .2-pre$(XEN_VENDORVERSION)
+export XEN_EXTRAVERSION ?= .1$(XEN_VENDORVERSION)
 export XEN_FULLVERSION   = $(XEN_VERSION).$(XEN_SUBVERSION)$(XEN_EXTRAVERSION)
 -include xen-version
 
@@ -116,6 +116,7 @@ delete-unfresh-files:
 		rm -f include/xen/compile.h; \
 	fi
 
+.banner: XEN_FULLVERSION := $$(echo $(XEN_FULLVERSION) | sed "s/-xs.*//")
 .banner: Makefile
 	@if which figlet >/dev/null 2>&1 ; then \
 		echo " Xen $(XEN_FULLVERSION)" | figlet -f tools/xen.flf > $@.tmp; \
diff --git a/xen/tools/scmversion b/xen/tools/scmversion
index b6ce049..c340589 100755
--- a/xen/tools/scmversion
+++ b/xen/tools/scmversion
@@ -41,6 +41,15 @@ scm_version()
 	if test -d .git && head=`git rev-parse --verify --short HEAD 2>/dev/null`; then
 		date=`git show -s --pretty="%ad" HEAD`
 
+		if test -d .git/patches/.git; then
+			# Guilt patch queue - Grab the revisions separately
+			head=`git rev-parse --verify --short=12 qparent`
+			pqhead=`git --git-dir=.git/patches/.git rev-parse --verify --short=12 HEAD`
+
+			printf '%s, pq %s' "$head" "$pqhead"
+			return
+		fi
+
 		printf '%s %s%s' "$date" git: $head
 
 		# Is this git on svn?
